# è®¾è®¡æ¨¡å¼ç¬¬äºŒåä¸€èŠ‚

## æ¨¡æ¿æ¨¡å¼

### å¼•è¨€

ç»å…¸åè¨€ï¼šâ€œ`é»æ˜å‰çš„å±é™©ï¼Œä½ åšå®ˆçš„ä½å—ï¼Ÿ`â€

æœ‰äººä¸¾è¿‡è¿™ä¹ˆä¸€ä¸ªä¾‹å­ï¼Œå…ˆç»™ä½ ä¸€å¼ åç‰Œå¤§å­¦çš„å½•å–é€šçŸ¥ä¹¦ï¼Œåˆ°æ˜¯è¦æ±‚ä½ æ¯å¤©äº”ç‚¹é’Ÿèµ·åºŠï¼ŒåäºŒç‚¹ç¡è§‰ğŸ˜´ï¼ŒåšæŒä¸‰å¹´ï¼Œé‚£ä¹ˆè¿™å¼ åç‰Œå¤§å­¦çš„å½•å–é€šçŸ¥ä¹¦å°±æ˜¯æœ‰æ•ˆçš„ã€‚å¦‚æœè¿™ä»¶äº‹æƒ…çœŸå®å‘ç”Ÿåœ¨äº†æˆ‘ä»¬èº«ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥åšæŒä¸‹æ¥å—ï¼Ÿè™½ç„¶è¿™ç§ä¾‹å­åœ¨æˆ‘ä»¬è¿™ç§å‡¡äººèº«ä¸Šå¾ˆéš¾å‡ºç°ï¼Œå› ä¸ºä»–æ‹¥æœ‰ä¸€ä¸ªå‡†ç¡®çš„å­¦ä¹ è·¯çº¿ã€‚ä½†åœ¨çœŸå®çš„æ˜¯ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰è¿™ä¹ˆæ˜ç¡®çš„å­¦ä¹ è·¯çº¿ï¼Œç”šè‡³æˆ‘ä»¬éƒ½æ²¡æœ‰åŠæ³•çŸ¥é“é»æ˜ä¼šä¸ä¼šåˆ°æ¥ã€‚ä½†æ˜¯åšæŒä¸‹å»ã€‚

è€å¸ˆè¦è¯´ï¼šâ€œ`åœ¨ä»»ä½•æ—¶å€™éƒ½è¦ä¸å¿˜åˆå¿ƒã€‚`â€

[é”®ç›˜ä¾ âŒ¨ï¸]()ã€[ç½‘ç»œå–·å­]()ï¼Œå‡ ä¹å½“ä½ åœ¨åŠªåŠ›åšæŒå»åšä¸€ä»¶äº‹æƒ…çš„æ—¶å€™ï¼Œåœ¨è¿™ä¸€æ¡è·¯ä¸Šä¼šé‡åˆ°å½¢å½¢è‰²è‰²çš„äººå’Œäº‹ã€‚æœ‰æ—¶å€™æ¥æ”¶å»ºè®®å®Œå–„è‡ªå·±ï¼Œä½†ä¸èƒ½æ”¾å¼ƒè‡ªå·±çš„åˆå¿ƒå’Œåº•çº¿ã€‚æœ‰æ—¶å€™åªåšæŒè‡ªå·±ä¹Ÿæ˜¯éš¾èƒ½å¯è´µçš„ã€‚[å­è·¯ä¹‹å‹‡ï¼Œå­è´¡ä¹‹è¾©ï¼Œå†‰æœ‰ä¹‹æ™ºï¼Œæ­¤ä¸‰å­è€…ï¼Œçš†å¤©ä¸‹ä¹‹æ‰€è°“éš¾èƒ½è€Œå¯è´µè€…ä¹Ÿ]()ã€‚é˜³å…‰å’ŒåŠªåŠ›æ˜¯è¿™ä¸ªä¸–ç•Œæœ€æ¸©æš–çš„ä¸œè¥¿ï¼ŒåŠ æ²¹åšæŒå¥½è‡ªå·±çš„é€‰çš„è·¯ã€‚

ç»å…¸è¯­å½•ï¼šâ€œ`æœªæ¥ä½ æˆåŠŸçš„æ—¶å€™ï¼Œè¯·å»æ„Ÿè°¢ä¸€ä¸‹å¢åŠ å¥‹æ–—çš„ä½ ã€‚`â€

å½“ä½ ä¸ºè‡ªå·±çš„ä¸€ä¸ªå†³å®šè€Œæ„Ÿåˆ°ä¸‡åˆ†å¼€å¿ƒğŸ˜„æ—¶ï¼Œæ˜¯ä¸æ˜¯ä¹Ÿéå¸¸æ„Ÿè°¢è‡ªå·±è¿˜å¥½åšæŒäº†ã€‚åšæŒã€åŠªåŠ›ã€ç»ˆèº«å­¦ä¹ ï¼Œä¼¼ä¹åœ¨ç¨‹åºå‘˜è¿™ä¸ªè¡Œä¸šæ˜¯ç¦»ä¸å¼€çš„ï¼Œå½“ä½ æ„æ„¿äºæŠŠè¿™å½“åšä¸€ä»½å¯ä»¥åŠªåŠ›çš„çˆ±å¥½æ—¶ï¼Œä½ å°±ä¼šæ„¿æ„ä¸ºæ­¤è€ŒåŠªåŠ›ã€‚è€Œæˆ‘ä»¬å¾ˆéš¾è¯´åªåœ¨æœºä¼šè¦æ¥æ—¶å‡†å¤‡ï¼Œè€Œæ˜¯ä¸€ç›´åŠªåŠ›ç­‰å¾…æœºä¼šã€‚ä¹Ÿå°±æ˜¯å¾ˆå¤šäººè¯´çš„åˆ«äººæŠ“ä½æœºä¼šæ˜¯å› ä¸ºä¸€ç›´åœ¨å‡†å¤‡ç€ã€‚

### æ¨¡æ¿æ¨¡å¼ ä»‹ç»

![wYCSs.png](https://i.im5i.com/2021/04/25/wYCSs.png)

æ¨¡æ¿æ¨¡å¼çš„æ ¸å¿ƒè®¾è®¡æ€è·¯æ˜¯é€šè¿‡åœ¨ï¼ŒæŠ½è±¡ç±»ä¸­å®šä¹‰æŠ½è±¡æ–¹æ³•çš„æ‰§è¡Œé¡ºåºï¼Œå¹¶å°†æŠ½è±¡æ–¹æ³•è®¾å®šä¸ºåªæœ‰å­ç±»å®ç°ï¼Œä½†ä¸è®¾è®¡`ç‹¬ç«‹è®¿é—®`çš„æ–¹æ³•ã€‚ç®€å•è¯´ä¹Ÿå°±æ˜¯æŠŠä½ å®‰æ’çš„æ˜æ˜ç™½ç™½çš„ã€‚

## åœºæ™¯æ¨¡æ‹Ÿ

![wYquQ.png](https://i.im5i.com/2021/04/25/wYquQ.png)

**åœ¨æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿçˆ¬è™«å„ç±»ç”µå•†å•†å“ï¼Œç”Ÿæˆè¥é”€æ¨å¹¿æµ·æŠ¥åœºæ™¯**

å…³äºæ¨¡ç‰ˆæ¨¡å¼çš„æ ¸å¿ƒç‚¹åœ¨äºç”±æŠ½è±¡ç±»å®šä¹‰æŠ½è±¡æ–¹æ³•æ‰§è¡Œç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´çˆ¶ç±»è§„å®šäº†å¥½ä¸€ç³»åˆ—çš„æ‰§è¡Œæ ‡å‡†ï¼Œè¿™äº›æ ‡å‡†çš„ä¸²è”æˆä¸€æ•´å¥—ä¸šåŠ¡æµç¨‹ã€‚

åœ¨è¿™ä¸ªåœºæ™¯ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿçˆ¬è™«çˆ¬å–å„ç±»å•†å®¶çš„å•†å“ä¿¡æ¯ï¼Œç”Ÿæˆæ¨å¹¿æµ·æŠ¥(`æµ·æŠ¥ä¸­å«å¸¦ä¸ªäººçš„é‚€è¯·ç `)èµšå–å•†å“è¿”åˆ©ã€‚*å£°æ˜ï¼Œè¿™é‡Œæ˜¯æ¨¡æ‹Ÿçˆ¬å–ï¼Œå¹¶æ²¡æœ‰çœŸçš„çˆ¬å–*

è€Œæ•´ä¸ªçš„çˆ¬å–è¿‡ç¨‹åˆ†ä¸ºï¼›æ¨¡æ‹Ÿç™»å½•ã€çˆ¬å–ä¿¡æ¯ã€ç”Ÿæˆæµ·æŠ¥ï¼Œè¿™ä¸‰ä¸ªæ­¥éª¤ï¼Œå¦å¤–ï¼›

```markdown
1. å› ä¸ºæœ‰äº›å•†å“åªæœ‰ç™»å½•åæ‰å¯ä»¥çˆ¬å–ï¼Œå¹¶ä¸”ç™»å½•å¯ä»¥çœ‹åˆ°ä¸€äº›ç‰¹å®šçš„ä»·æ ¼è¿™ä¸æœªç™»å½•ç”¨æˆ·çœ‹åˆ°çš„ä»·æ ¼ä¸åŒã€‚

2. ä¸åŒçš„ç”µå•†ç½‘ç«™çˆ¬å–æ–¹å¼ä¸åŒï¼Œè§£ææ–¹å¼ä¹Ÿä¸åŒï¼Œå› æ­¤å¯ä»¥ä½œä¸ºæ¯ä¸€ä¸ªå®ç°ç±»ä¸­çš„ç‰¹å®šå®ç°ã€‚

3. ç”Ÿæˆæµ·æŠ¥çš„æ­¥éª¤åŸºæœ¬ä¸€æ ·ï¼Œä½†ä¼šæœ‰ç‰¹å®šçš„å•†å“æ¥æºæ ‡è¯†ã€‚æ‰€ä»¥è¿™æ ·ä¸‰ä¸ªæ­¥éª¤å¯ä»¥ä½¿ç”¨æ¨¡ç‰ˆæ¨¡å¼æ¥è®¾å®šï¼Œå¹¶æœ‰å…·ä½“çš„åœºæ™¯åšå­ç±»å®ç°ã€‚
```

## æ¨¡æ¿æ¨¡å¼ é‡æ„ä»£ç 

### ä»£ç ç›®å½•

```markdown
- template-mode-1
  - src.main.java.com.hcy
    - impl
      - DangDangNetMall.java
      - JDNetMall.java
      - TaoBaoNetMall.java
    - HttpClient.java
    - NetMall.java
```

### æ¨¡å‹ç»“æ„

![wYvx3.png](https://i.im5i.com/2021/04/25/wYvx3.png)

### ä»£ç å®ç°

```java
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;

import java.util.Map;

/**
 * åŸºç¡€ç”µå•†æ¨å¹¿æœåŠ¡
 * 1. ç”Ÿæˆæœ€ä¼˜ä»·å•†å“æµ·æŠ¥
 * 2. æµ·æŠ¥å«å¸¦æ¨å¹¿é‚€è¯·ç 
 */
public abstract class NetMall {

    protected Logger logger = LoggerFactory.getLogger(NetMall.class);

    // ç”¨æˆ·ID
    String uId;
    // ç”¨æˆ·å¯†ç 
    String uPwd;

    public NetMall(String uId, String uPwd) {
        this.uId = uId;
        this.uPwd = uPwd;
    }

    /**
     * ç”Ÿæˆå•†å“æ¨å¹¿æµ·æŠ¥
     *
     * @param skuUrl å•†å“åœ°å€(äº¬ä¸œã€æ·˜å®ã€å½“å½“)
     * @return æµ·æŠ¥å›¾ç‰‡base64ä½ä¿¡æ¯
     */
    public String generateGoodsPoster(String skuUrl) {
        // 1. éªŒè¯ç™»å½•
        if (!login(uId, uPwd)) {
            return null;
        }
        // 2. çˆ¬è™«å•†å“
        Map<String, String> reptile = reptile(skuUrl);
        // 3. ç»„è£…æµ·æŠ¥
        return createBase64(reptile);
    }

    /**
     * æ¨¡æ‹Ÿç™»å½•
     * @author HCY
     * @since 2021/4/25 1:14 ä¸‹åˆ
     * @param uId:
     * @param uPwd:
     * @return java.lang.Boolean
    */
    protected abstract Boolean login(String uId, String uPwd);

    /**
     * çˆ¬è™«æå–å•†å“ä¿¡æ¯(ç™»å½•åçš„ä¼˜æƒ ä»·æ ¼)
     * @author HCY
     * @since 2021/4/25 1:14 ä¸‹åˆ
     * @param skuUrl:
     * @return java.util.Map<java.lang.String,java.lang.String>
    */
    protected abstract Map<String, String> reptile(String skuUrl);

    /**
     * ç”Ÿæˆå•†å“æµ·æŠ¥ä¿¡æ¯
     * @author HCY
     * @since 2021/4/25 1:16 ä¸‹åˆ
     * @param goodsInfo:
     * @return java.lang.String
    */
    protected abstract String createBase64(Map<String, String> goodsInfo);

}
```

```java
import com.alibaba.fastjson.JSON;
import com.hcy.HttpClient;
import com.hcy.NetMall;


import java.util.Base64;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

/**
 * æ¨¡æ‹ŸJDå•†åŸ
 */
public class JDNetMall extends NetMall {

    public JDNetMall(String uId, String uPwd) {
        super(uId, uPwd);
    }

    @Override
    public Boolean login(String uId, String uPwd) {
        logger.info("æ¨¡æ‹Ÿäº¬ä¸œç”¨æˆ·ç™»å½• uIdï¼š{} uPwdï¼š{}", uId, uPwd);
        return true;
    }

    @Override
    public Map<String, String> reptile(String skuUrl) {
        String str = HttpClient.doGet(skuUrl);
        Pattern p9 = Pattern.compile("(?<=title\\>).*(?=</title)");
        Matcher m9 = p9.matcher(str);
        Map<String, String> map = new ConcurrentHashMap<String, String>();
        if (m9.find()) {
            map.put("name", m9.group());
        }
        map.put("price", "5999.00");
        logger.info("æ¨¡æ‹Ÿäº¬ä¸œå•†å“çˆ¬è™«è§£æï¼š{} | {} å…ƒ {}", map.get("name"), map.get("price"), skuUrl);
        return map;
    }

    @Override
    public String createBase64(Map<String, String> goodsInfo) {
        Base64.Encoder encoder = Base64.getEncoder();
        logger.info("æ¨¡æ‹Ÿç”Ÿæˆäº¬ä¸œå•†å“base64æµ·æŠ¥");
        return String.valueOf(encoder.encode(JSON.toJSONString(goodsInfo).getBytes()));
    }

}
```

```java
import com.alibaba.fastjson.JSON;
import com.hcy.HttpClient;
import com.hcy.NetMall;


import java.util.Base64;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class TaoBaoNetMall extends NetMall {

    public TaoBaoNetMall(String uId, String uPwd) {
        super(uId, uPwd);
    }

    @Override
    public Boolean login(String uId, String uPwd) {
        logger.info("æ¨¡æ‹Ÿæ·˜å®ç”¨æˆ·ç™»å½• uIdï¼š{} uPwdï¼š{}", uId, uPwd);
        return true;
    }

    @Override
    public Map<String, String> reptile(String skuUrl) {
        String str = HttpClient.doGet(skuUrl);
        Pattern p9 = Pattern.compile("(?<=title\\>).*(?=</title)");
        Matcher m9 = p9.matcher(str);
        Map<String, String> map = new ConcurrentHashMap<String, String>();
        if (m9.find()) {
            map.put("name", m9.group());
        }
        map.put("price", "4799.00");
        logger.info("æ¨¡æ‹Ÿæ·˜å®å•†å“çˆ¬è™«è§£æï¼š{} | {} å…ƒ {}", map.get("name"), map.get("price"), skuUrl);
        return map;
    }

    @Override
    public String createBase64(Map<String, String> goodsInfo) {
        Base64.Encoder encoder = Base64.getEncoder();
        logger.info("æ¨¡æ‹Ÿç”Ÿæˆæ·˜å®å•†å“base64æµ·æŠ¥");
        return String.valueOf(encoder.encode(JSON.toJSONString(goodsInfo).getBytes()));
    }

}
```

```java
import com.alibaba.fastjson.JSON;
import com.hcy.HttpClient;
import com.hcy.NetMall;
import java.util.Base64;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;
import java.util.regex.Matcher;
import java.util.regex.Pattern;

public class DangDangNetMall extends NetMall {

    public DangDangNetMall(String uId, String uPwd) {
        super(uId, uPwd);
    }

    @Override
    public Boolean login(String uId, String uPwd) {
        logger.info("æ¨¡æ‹Ÿå½“å½“ç”¨æˆ·ç™»å½• uIdï¼š{} uPwdï¼š{}", uId, uPwd);
        return true;
    }

    @Override
    public Map<String, String> reptile(String skuUrl) {
        String str = HttpClient.doGet(skuUrl);
        Pattern p9 = Pattern.compile("(?<=title\\>).*(?=</title)");
        Matcher m9 = p9.matcher(str);
        Map<String, String> map = new ConcurrentHashMap<String, String>();
        if (m9.find()) {
            map.put("name", m9.group());
        }
        map.put("price", "4548.00");
        logger.info("æ¨¡æ‹Ÿå½“å½“å•†å“çˆ¬è™«è§£æï¼š{} | {} å…ƒ {}", map.get("name"), map.get("price"), skuUrl);
        return map;
    }

    @Override
    public String createBase64(Map<String, String> goodsInfo) {
        Base64.Encoder encoder = Base64.getEncoder();
        logger.info("æ¨¡æ‹Ÿç”Ÿæˆå½“å½“å•†å“base64æµ·æŠ¥");
        return String.valueOf(encoder.encode(JSON.toJSONString(goodsInfo).getBytes()));
    }

}
```

## æ€»ç»“

```markdown
- é€šè¿‡ä¸Šé¢çš„å®ç°å¯ä»¥çœ‹åˆ°æ¨¡ç‰ˆæ¨¡å¼åœ¨å®šä¹‰ç»Ÿä¸€ç»“æ„ä¹Ÿå°±æ˜¯æ‰§è¡Œæ ‡å‡†ä¸Šéå¸¸æ–¹ä¾¿ï¼Œä¹Ÿå°±å¾ˆå¥½çš„æ§åˆ¶äº†åç»­çš„å®ç°è€…ä¸ç”¨å…³å¿ƒè°ƒç”¨é€»è¾‘ï¼ŒæŒ‰ç…§ç»Ÿä¸€æ–¹å¼æ‰§è¡Œã€‚é‚£ä¹ˆç±»çš„ç»§æ‰¿è€…åªéœ€è¦å…³å¿ƒå…·ä½“çš„ä¸šåŠ¡é€»è¾‘å®ç°å³å¯ã€‚

- å¦å¤–æ¨¡ç‰ˆæ¨¡å¼ä¹Ÿæ˜¯ä¸ºäº†è§£å†³å­ç±»é€šç”¨æ–¹æ³•ï¼Œæ”¾åˆ°çˆ¶ç±»ä¸­è®¾è®¡çš„ä¼˜åŒ–ã€‚è®©æ¯ä¸€ä¸ªå­ç±»åªåšå­ç±»éœ€è¦å®Œæˆçš„å†…å®¹ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå…¶ä»–é€»è¾‘ã€‚è¿™æ ·æå–å…¬ç”¨ä»£ç ï¼Œè¡Œä¸ºç”±çˆ¶ç±»ç®¡ç†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ï¼Œä¹Ÿå°±éå¸¸æœ‰åˆ©äºå¼€å‘æ‹“å±•å’Œè¿­ä»£ã€‚
```

