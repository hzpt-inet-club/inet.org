<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.35">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>设计模式第一节 | INet</title><meta name="description" content="INet">
    <link rel="modulepreload" href="/inet.org/assets/app.44bb4c6a.js"><link rel="modulepreload" href="/inet.org/assets/01.html.fc1da432.js"><link rel="modulepreload" href="/inet.org/assets/01.html.c3cb9b85.js"><link rel="modulepreload" href="/inet.org/assets/plugin-vue_export-helper.21dcd24c.js">
    <link rel="stylesheet" href="/inet.org/assets/style.45c657d4.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header ref_key="navbar" class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/inet.org/" class=""><img class="logo" src="/inet.org/img/logo.svg" alt="INet"><span class="site-name can-hide">INet</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><nav class="navbar-items can-hide"><!--[--><div class="navbar-item"><a href="/inet.org/introduce/" class="" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/team/" class="" aria-label="团队"><!--[--><!--]--> 团队 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/honor/" class="" aria-label="荣誉"><!--[--><!--]--> 荣誉 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/surroundings/" class="" aria-label="环境"><!--[--><!--]--> 环境 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/news/" class="" aria-label="新闻"><!--[--><!--]--> 新闻 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/activity/" class="" aria-label="活动"><!--[--><!--]--> 活动 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="友链"><span class="title">友链</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="友链"><span class="title">友链</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/camera/" rel="noopener noreferrer" target="_blank" aria-label="人脸识别签到打卡系统"><!--[--><!--]--> 人脸识别签到打卡系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://2e19q21138.yicp.fun/" rel="noopener noreferrer" target="_blank" aria-label="二手房价分析系统"><!--[--><!--]--> 二手房价分析系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/gaode/" rel="noopener noreferrer" target="_blank" aria-label="高德租房系统"><!--[--><!--]--> 高德租房系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/douban/" rel="noopener noreferrer" target="_blank" aria-label="豆瓣电影分析系统"><!--[--><!--]--> 豆瓣电影分析系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://47.115.205.14/#/pages/index/index" rel="noopener noreferrer" target="_blank" aria-label="上课考勤签到程序"><!--[--><!--]--> 上课考勤签到程序 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/inet.org/collect/" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/blog/" class="router-link-active" aria-label="博客"><!--[--><!--]--> 博客 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><div id="docsearch-container"></div></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><nav class="navbar-items"><!--[--><div class="navbar-item"><a href="/inet.org/introduce/" class="" aria-label="介绍"><!--[--><!--]--> 介绍 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/team/" class="" aria-label="团队"><!--[--><!--]--> 团队 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/honor/" class="" aria-label="荣誉"><!--[--><!--]--> 荣誉 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/surroundings/" class="" aria-label="环境"><!--[--><!--]--> 环境 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/news/" class="" aria-label="新闻"><!--[--><!--]--> 新闻 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/activity/" class="" aria-label="活动"><!--[--><!--]--> 活动 <!--[--><!--]--></a></div><div class="navbar-item"><div class="navbar-dropdown-wrapper"><button class="navbar-dropdown-title" type="button" aria-label="友链"><span class="title">友链</span><span class="arrow down"></span></button><button class="navbar-dropdown-title-mobile" type="button" aria-label="友链"><span class="title">友链</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="navbar-dropdown"><!--[--><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/camera/" rel="noopener noreferrer" target="_blank" aria-label="人脸识别签到打卡系统"><!--[--><!--]--> 人脸识别签到打卡系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="https://2e19q21138.yicp.fun/" rel="noopener noreferrer" target="_blank" aria-label="二手房价分析系统"><!--[--><!--]--> 二手房价分析系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/gaode/" rel="noopener noreferrer" target="_blank" aria-label="高德租房系统"><!--[--><!--]--> 高德租房系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://1.12.74.98/douban/" rel="noopener noreferrer" target="_blank" aria-label="豆瓣电影分析系统"><!--[--><!--]--> 豆瓣电影分析系统 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><li class="navbar-dropdown-item"><a class="external-link" href="http://47.115.205.14/#/pages/index/index" rel="noopener noreferrer" target="_blank" aria-label="上课考勤签到程序"><!--[--><!--]--> 上课考勤签到程序 <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-item"><a href="/inet.org/collect/" class="" aria-label="收藏"><!--[--><!--]--> 收藏 <!--[--><!--]--></a></div><div class="navbar-item"><a href="/inet.org/blog/" class="router-link-active" aria-label="博客"><!--[--><!--]--> 博客 <!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><a href="/inet.org/blog/introduce/introduce.md" class="sidebar-item sidebar-heading" aria-label="博客介绍"><!--[--><!--]--> 博客介绍 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/TypeScript-course.md" class="sidebar-item sidebar-heading" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/Serializable.md" class="sidebar-item sidebar-heading" aria-label="Serializable"><!--[--><!--]--> Serializable <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/EasyPOI.md" class="sidebar-item sidebar-heading" aria-label="EasyPOI"><!--[--><!--]--> EasyPOI <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/Nginx.md" class="sidebar-item sidebar-heading" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/Docker.md" class="sidebar-item sidebar-heading" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/VVT.md" class="sidebar-item sidebar-heading" aria-label="Vue.js+Vite.js+TypeScript"><!--[--><!--]--> Vue.js+Vite.js+TypeScript <!--[--><!--]--></a><!----></li><li><p tabindex="0" class="sidebar-item sidebar-heading active collapsible">基于Java的设计模式 <span class="down arrow"></span></p><!--[--><ul style="" class="sidebar-item-children"><!--[--><li><a href="/inet.org/blog/detail/design-patterns/README.md" class="sidebar-item" aria-label="目录"><!--[--><!--]--> 目录 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/01.md" class="sidebar-item active" aria-label="工厂模式"><!--[--><!--]--> 工厂模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/02.md" class="sidebar-item" aria-label="抽象工厂模式"><!--[--><!--]--> 抽象工厂模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/03.md" class="sidebar-item" aria-label="建造者模式"><!--[--><!--]--> 建造者模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/04.md" class="sidebar-item" aria-label="原型模式"><!--[--><!--]--> 原型模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/05.md" class="sidebar-item" aria-label="单例模式"><!--[--><!--]--> 单例模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/06.md" class="sidebar-item" aria-label="适配器模式"><!--[--><!--]--> 适配器模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/07.md" class="sidebar-item" aria-label="桥接模式"><!--[--><!--]--> 桥接模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/08.md" class="sidebar-item" aria-label="组合模式"><!--[--><!--]--> 组合模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/09.md" class="sidebar-item" aria-label="装饰器模式"><!--[--><!--]--> 装饰器模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/10.md" class="sidebar-item" aria-label="外观模式"><!--[--><!--]--> 外观模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/11.md" class="sidebar-item" aria-label="享元模式"><!--[--><!--]--> 享元模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/12.md" class="sidebar-item" aria-label="代理模式"><!--[--><!--]--> 代理模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/13.md" class="sidebar-item" aria-label="责任链模式"><!--[--><!--]--> 责任链模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/14.md" class="sidebar-item" aria-label="命令模式"><!--[--><!--]--> 命令模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/15.md" class="sidebar-item" aria-label="迭代器模式"><!--[--><!--]--> 迭代器模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/16.md" class="sidebar-item" aria-label="中介者模式"><!--[--><!--]--> 中介者模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/17.md" class="sidebar-item" aria-label="备忘录模式"><!--[--><!--]--> 备忘录模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/18.md" class="sidebar-item" aria-label="观察者模式"><!--[--><!--]--> 观察者模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/19.md" class="sidebar-item" aria-label="状态模式"><!--[--><!--]--> 状态模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/20.md" class="sidebar-item" aria-label="策略模式"><!--[--><!--]--> 策略模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/21.md" class="sidebar-item" aria-label="模板模式"><!--[--><!--]--> 模板模式 <!--[--><!--]--></a><!----></li><li><a href="/inet.org/blog/detail/design-patterns/22.md" class="sidebar-item" aria-label="访问者模式"><!--[--><!--]--> 访问者模式 <!--[--><!--]--></a><!----></li><!--]--></ul><!--]--></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="设计模式第一节" tabindex="-1"><a class="header-anchor" href="#设计模式第一节" aria-hidden="true">#</a> 设计模式第一节</h1><h2 id="_1-工厂模式" tabindex="-1"><a class="header-anchor" href="#_1-工厂模式" aria-hidden="true">#</a> 1. 工厂模式</h2><h3 id="引言" tabindex="-1"><a class="header-anchor" href="#引言" aria-hidden="true">#</a> 引言</h3><p>老人们常说：“<code>好看的代码千篇一律，恶心的程序员升职加薪</code>”</p><p>几乎是所有的程序员都或多或少的进行了解，但是对于我而言，写代码就是喜欢一直嗦到底。我这样的开发过程也被我称为三步走，定义属性，创建方法，调用展示，Done。这样开发的时候非常舒服，但是如果需要重构或者改写，就非常的麻烦了。</p><p>好的代码不只为了完成现有功能，也会考虑后续扩展。在结构设计上松耦合易读易扩展，在领域实现上 高内聚不不对外暴漏实现细节不被外部干扰。而这就有点像家里三居(MVC)室、四居(DDD)室的装修，你不会允许几十万的房⼦把⾛线水管裸漏在外面，也不会允许把马桶放到厨房，炉灶安装到卫⽣生间一样。</p><p><strong>谁发明了设计模式 ？</strong></p><p>设计模式的概念最早是由<kbd>克里斯托佛·亚历山大</kbd>在其著作<kbd>《建筑模式语⾔言》</kbd>中首 次提出的。 本书介绍了城市设计的 “语⾔”，提供了了253个描述城镇、邻里、住宅、花园、房间及⻄部构造的模式， 而此类 “语言” 的基本单元就是模式。后来， 埃里希·伽玛 、 约翰·弗利赛德斯 、 拉尔夫·约翰逊 和 理查德·赫尔姆 这四位作者接受了模式的概念。 1994 年年， 他们出版了<kbd>《设计模式: 可复⽤面向对象软件的基础》</kbd>⼀一书， 将设计模式的概念应用到程序开发领域中。</p><h3 id="工厂方法模式介绍" tabindex="-1"><a class="header-anchor" href="#工厂方法模式介绍" aria-hidden="true">#</a> 工厂方法模式介绍</h3><p><img src="https://i.im5i.com/2021/03/12/h37zn.png" alt="工厂模式介绍图"></p><p>工厂模式又被称为工厂方法模式，是一种创建型的开发模式，其在父类中提供一个创建对象的方法，运行子类决定实例化对象的类型。</p><p>当然这种设计模式也是Java代码开发中比较常见的一种模式，他的主要意图就是定义一个创建对象的接口，让其子类决定自己实例化哪一个工厂类模型，⼯⼚模式使其创建过程延迟到⼦类进⾏。</p><p>简单来说就是为了代码结构的扩展性，屏蔽每一个功能类中的具体实现逻辑。让外部可以更加简单的知道调用即可，同时我们也需要去掉众多的<kbd>ifelse</kbd>。当然这也是有一定缺陷的，比如实现类的数目众多，如何去进行维护，怎样进行减少开发成本？但是这些问题，我们都坚信会在以后多种设计模式的搭配使用的情况下一一解决。</p><h2 id="_2-项目需求" tabindex="-1"><a class="header-anchor" href="#_2-项目需求" aria-hidden="true">#</a> 2. 项目需求</h2><h3 id="模拟发奖的多种商品" tabindex="-1"><a class="header-anchor" href="#模拟发奖的多种商品" aria-hidden="true">#</a> 模拟发奖的多种商品</h3><p><img src="https://i.im5i.com/2021/03/12/h3ONl.png" alt="模拟发奖的多种商品"></p><p>为了可以让整个案例更加贴合实际的开发情况，这里模拟互联网中在经营场景下的业务，由于营销场景的复杂，多变，临时的特性，所以他需要的设计是更加深入，否则我们进行多种紧急的CRUD操作，会手忙脚乱的写代码，从而导致代码结构出现混乱不堪，难以维护的情况。</p><p>在营销场景中经常会有某个用户做了一些操作;打卡、分享、留言、邀请注册等等，进行返利积分，最 后通过积分在兑换商品，从⽽促活和拉新。</p><p>那么在这⾥我们模拟积分兑换中的发放多种类型商品，假如现在我们有如下三种类型的商品接口;</p><table><thead><tr><th>类型</th><th>接口</th></tr></thead><tbody><tr><td>优惠券</td><td><code>CouponResult sendCoupon(String uId, String couponNumber, String uuid)</code></td></tr><tr><td>实物商品</td><td><code>Boolean deliverGoods(DeliverReq req)</code></td></tr><tr><td>第三方视频网址兑换卡</td><td><code>void grantToken(String bindMobileNumber, String cardId)</code></td></tr></tbody></table><p>从以上的接口来看有如下信息：</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> 三个接口返回类型不同，有对象类型、布尔类型，还有一个空类型。
<span class="token list punctuation">-</span> 入参不同，发放优惠券需要防重、兑换卡需要卡ID、实物商品需要发货位置（对象中含有）。
<span class="token list punctuation">-</span> 可能会随着后续的业务的发展，会新增其他种商品类型。因为我们所有的开发需求都是随着业务对市场的拓展而带来的。
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="场景模拟工程-用于提供三组不同奖品的发放接口" tabindex="-1"><a class="header-anchor" href="#场景模拟工程-用于提供三组不同奖品的发放接口" aria-hidden="true">#</a> 场景模拟工程，用于提供三组不同奖品的发放接口</h3><p><strong>工程目录</strong></p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> hcy-design-mode-factory-method-model-1-00
	<span class="token list punctuation">-</span> src
		<span class="token list punctuation">-</span> main
			<span class="token list punctuation">-</span> java
				<span class="token list punctuation">-</span> com
					<span class="token list punctuation">-</span> hcy
						<span class="token list punctuation">-</span> code
							<span class="token list punctuation">-</span> entity
							<span class="token list punctuation">-</span> info
							<span class="token list punctuation">-</span> service
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_3-正常解决方案" tabindex="-1"><a class="header-anchor" href="#_3-正常解决方案" aria-hidden="true">#</a> 3. 正常解决方案</h2><h3 id="工程结构" tabindex="-1"><a class="header-anchor" href="#工程结构" aria-hidden="true">#</a> 工程结构</h3><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> hcy-design-mode-factory-method-model-1-01
	<span class="token list punctuation">-</span> src	
		<span class="token list punctuation">-</span> main
			<span class="token list punctuation">-</span> java
				<span class="token list punctuation">-</span> com
					<span class="token list punctuation">-</span> hcy
						<span class="token list punctuation">-</span> controller
							<span class="token list punctuation">-</span> PrizeController.java
						<span class="token list punctuation">-</span> entity
							<span class="token list punctuation">-</span> AwardReq.java
							<span class="token list punctuation">-</span> AwardRes.java
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这个项目十分简单，一个入参对象<kbd>AwardReq</kbd>、一个出参对象<kbd>AwardRes</kbd>，以及一个controller类<kbd>PrizeController</kbd></p><h3 id="controller实现需求" tabindex="-1"><a class="header-anchor" href="#controller实现需求" aria-hidden="true">#</a> controller实现需求</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">CouponResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DeliverReq</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">CouponService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">GoodsService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IQiYiCardService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AwardReq</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">AwardRes</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 进行奖品发送
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/12 下午5:25
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PrizeController</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 添加日志
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">PrizeController</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">AwardRes</span> <span class="token function">awardToUser</span><span class="token punctuation">(</span><span class="token class-name">AwardReq</span> req<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> reqJson <span class="token operator">=</span> JSON<span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">AwardRes</span> awardRes <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;奖品发放开始{}.req:{}&quot;</span><span class="token punctuation">,</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>reqJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//按照不同类型方法商品[1优惠券、2实物商品、3第三方兑换卡(爱奇艺)]</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getAwardType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">CouponService</span> couponService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">CouponResult</span> couponResult <span class="token operator">=</span> couponService<span class="token punctuation">.</span><span class="token function">sendCoupon</span><span class="token punctuation">(</span>
                          req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> req<span class="token punctuation">.</span><span class="token function">getAwardNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                        <span class="token punctuation">,</span> req<span class="token punctuation">.</span><span class="token function">getBizId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>couponResult<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;发送成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                    awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0001&quot;</span><span class="token punctuation">,</span>couponResult<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getAwardType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">GoodsService</span> goodsService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoodsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">DeliverReq</span> deliverReq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeliverReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token function">queryUserName</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setUserPhone</span><span class="token punctuation">(</span><span class="token function">queryUserPhoneNumber</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setSku</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getAwardNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setOrderId</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getBizId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setConsigneeUserName</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getExtMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setUserPhone</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getExtMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserPhone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                deliverReq<span class="token punctuation">.</span><span class="token function">setConsigneeUserAddress</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getExtMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserAddress&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>goodsService<span class="token punctuation">.</span><span class="token function">deliverGoods</span><span class="token punctuation">(</span>deliverReq<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;发送成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token punctuation">{</span>
                    awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;发送失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getAwardType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token class-name">String</span> bindMobileNumber <span class="token operator">=</span> <span class="token function">queryUserPhoneNumber</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">IQiYiCardService</span> iQiYiCardService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IQiYiCardService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                iQiYiCardService<span class="token punctuation">.</span><span class="token function">grantToken</span><span class="token punctuation">(</span>bindMobileNumber<span class="token punctuation">,</span>req<span class="token punctuation">.</span><span class="token function">getAwardNumber</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;发送成功&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;奖品发放完成&quot;</span><span class="token punctuation">,</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            logger<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;奖品发放失败{}。req:{}&quot;</span><span class="token punctuation">,</span>req<span class="token punctuation">.</span><span class="token function">getUId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>reqJson<span class="token punctuation">)</span><span class="token punctuation">;</span>
            awardRes <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardRes</span><span class="token punctuation">(</span><span class="token string">&quot;0001&quot;</span><span class="token punctuation">,</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> awardRes<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">queryUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;晓寻遥&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">queryUserPhoneNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;12345678901&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br></div></div><p>从上面的代码可以发现有很多问题</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> 使用了大量的if...else非常直接的实现出来业务需求的代码，如果单从业务角度看，研发如期甚至提前实现了所有功能。

<span class="token list punctuation">-</span> 这样的代码目前可以发现并不会有太大的问题，但是如果经过版本的迭代和扩展，再次接受这段代码的时候将会十分的痛苦。重构成本高到需要去理清之前的每一个接口的使用，测试回归验证的时间更长，需要全部验证一次。这才是很多人不接手别人的代码原因。
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="测试controller" tabindex="-1"><a class="header-anchor" href="#测试controller" aria-hidden="true">#</a> 测试controller</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_PrizeController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">PrizeController</span> prizeController <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PrizeController</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\r\n 模拟发放优惠券的测试 \r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//开始模拟发放优惠券</span>
    <span class="token class-name">AwardReq</span> req_01 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_01<span class="token punctuation">.</span><span class="token function">setUId</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_01<span class="token punctuation">.</span><span class="token function">setAwardType</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_01<span class="token punctuation">.</span><span class="token function">setAwardNumber</span><span class="token punctuation">(</span><span class="token string">&quot;EGM12345678901234567890&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_01<span class="token punctuation">.</span><span class="token function">setBizId</span><span class="token punctuation">(</span><span class="token string">&quot;12313131321313&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AwardRes</span> awardRes_01 <span class="token operator">=</span> prizeController<span class="token punctuation">.</span><span class="token function">awardToUser</span><span class="token punctuation">(</span>req_01<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数：{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>req_01<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果：{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>awardRes_01<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\r\n 模拟发放实物商品的测试 \r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AwardReq</span> req_02 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_02<span class="token punctuation">.</span><span class="token function">setUId</span><span class="token punctuation">(</span><span class="token string">&quot;10002&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_02<span class="token punctuation">.</span><span class="token function">setAwardType</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_02<span class="token punctuation">.</span><span class="token function">setAwardNumber</span><span class="token punctuation">(</span><span class="token string">&quot;EGM12345678901234567890&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_02<span class="token punctuation">.</span><span class="token function">setBizId</span><span class="token punctuation">(</span><span class="token string">&quot;12313131321313&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserName&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;飞机&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserPhone&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;12345678901&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserAddress&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;浙江省&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req_02<span class="token punctuation">.</span><span class="token function">setExtMap</span><span class="token punctuation">(</span>extMap<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AwardRes</span> awardRes_02 <span class="token operator">=</span> prizeController<span class="token punctuation">.</span><span class="token function">awardToUser</span><span class="token punctuation">(</span>req_02<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数{}&quot;</span><span class="token punctuation">,</span>JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>req_02<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果{}&quot;</span><span class="token punctuation">,</span>JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>awardRes_02<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;\r\n第三方兑换卡(爱奇艺)\r\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AwardReq</span> req03 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">AwardReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req03<span class="token punctuation">.</span><span class="token function">setUId</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req03<span class="token punctuation">.</span><span class="token function">setAwardType</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    req03<span class="token punctuation">.</span><span class="token function">setAwardNumber</span><span class="token punctuation">(</span><span class="token string">&quot;AQY1xjkUodl8LO975GdfrYUio&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">AwardRes</span> awardRes03 <span class="token operator">=</span> prizeController<span class="token punctuation">.</span><span class="token function">awardToUser</span><span class="token punctuation">(</span>req03<span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数：{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>req03<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果：{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>awardRes03<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><p><strong>结果</strong></p><div class="language-config ext-config line-numbers-mode"><pre class="language-config"><code> 模拟发放优惠券的测试 
19:53:00.066 [main] INFO  com.hcy.controller.PrizeController - 奖品发放开始10001.req:{&quot;awardNumber&quot;:&quot;EGM12345678901234567890&quot;,&quot;awardType&quot;:1,&quot;bizId&quot;:&quot;12313131321313&quot;,&quot;uId&quot;:&quot;10001&quot;}
模拟发放优惠券一张：10001,EGM12345678901234567890,12313131321313
19:53:00.098 [main] INFO  com.hcy.controller.PrizeController - 奖品发放完成
19:53:00.102 [main] INFO  com.hcy.AppTest - 请求参数：{&quot;uId&quot;:&quot;10001&quot;,&quot;bizId&quot;:&quot;12313131321313&quot;,&quot;awardNumber&quot;:&quot;EGM12345678901234567890&quot;,&quot;awardType&quot;:1}
19:53:00.105 [main] INFO  com.hcy.AppTest - 测试结果：{&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;发送成功&quot;}
 模拟发放实物商品的测试 
19:53:00.105 [main] INFO  com.hcy.controller.PrizeController - 奖品发放开始10002.req:{&quot;awardNumber&quot;:&quot;EGM12345678901234567890&quot;,&quot;awardType&quot;:1,&quot;bizId&quot;:&quot;12313131321313&quot;,&quot;extMap&quot;:{&quot;consigneeUserName&quot;:&quot;飞机&quot;,&quot;consigneeUserPhone&quot;:&quot;12345678901&quot;,&quot;consigneeUserAddress&quot;:&quot;浙江省&quot;},&quot;uId&quot;:&quot;10002&quot;}
模拟发放优惠券一张：10002,EGM12345678901234567890,12313131321313
19:53:00.105 [main] INFO  com.hcy.controller.PrizeController - 奖品发放完成
19:53:00.106 [main] INFO  com.hcy.AppTest - 请求参数{&quot;extMap&quot;:{&quot;consigneeUserName&quot;:&quot;飞机&quot;,&quot;consigneeUserAddress&quot;:&quot;浙江省&quot;,&quot;consigneeUserPhone&quot;:&quot;12345678901&quot;},&quot;uId&quot;:&quot;10002&quot;,&quot;bizId&quot;:&quot;12313131321313&quot;,&quot;awardNumber&quot;:&quot;EGM12345678901234567890&quot;,&quot;awardType&quot;:1}
19:53:00.109 [main] INFO  com.hcy.AppTest - 测试结果{&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;发送成功&quot;}
第三方兑换卡(爱奇艺)
19:53:00.110 [main] INFO  com.hcy.controller.PrizeController - 奖品发放开始10001.req:{&quot;awardNumber&quot;:&quot;AQY1xjkUodl8LO975GdfrYUio&quot;,&quot;awardType&quot;:3,&quot;uId&quot;:&quot;10001&quot;}
模拟发放爱奇艺会员卡一张：12345678901，AQY1xjkUodl8LO975GdfrYUio
19:53:00.126 [main] INFO  com.hcy.controller.PrizeController - 奖品发放完成
19:53:00.130 [main] INFO  com.hcy.AppTest - 请求参数：{&quot;uId&quot;:&quot;10001&quot;,&quot;awardNumber&quot;:&quot;AQY1xjkUodl8LO975GdfrYUio&quot;,&quot;awardType&quot;:3}
19:53:00.130 [main] INFO  com.hcy.AppTest - 测试结果：{&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;发送成功&quot;}
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h2 id="_4-使用工厂方法模式优化代码" tabindex="-1"><a class="header-anchor" href="#_4-使用工厂方法模式优化代码" aria-hidden="true">#</a> 4. 使用工厂方法模式优化代码</h2><h3 id="工程结构-1" tabindex="-1"><a class="header-anchor" href="#工程结构-1" aria-hidden="true">#</a> 工程结构</h3><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> hcy-design-mode-factory-method-model-1-02
	<span class="token list punctuation">-</span> main
		<span class="token list punctuation">-</span> src
			<span class="token list punctuation">-</span> hcy
				<span class="token list punctuation">-</span> service
					<span class="token list punctuation">-</span> impl
					<span class="token list punctuation">-</span> CardCommodityService.java
					<span class="token list punctuation">-</span> CouponCommodityService.java
					<span class="token list punctuation">-</span> GoodsCommodityService.java
				<span class="token list punctuation">-</span> factor
					<span class="token list punctuation">-</span> StoreFactory.java
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="service" tabindex="-1"><a class="header-anchor" href="#service" aria-hidden="true">#</a> service</h3><h4 id="接口" tabindex="-1"><a class="header-anchor" href="#接口" aria-hidden="true">#</a> 接口</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 奖品发放
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/12 下午11:48
*/</span>
<span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">ICommodity</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * 奖品发放接口
     * <span class="token keyword">@author</span> HCY
     * <span class="token keyword">@since</span> 2021/3/12 下午11:50
     * <span class="token keyword">@param</span> <span class="token parameter">uId</span>: 用户序号
     * <span class="token keyword">@param</span> <span class="token parameter">commodityId</span>:奖品ID
     * <span class="token keyword">@param</span> <span class="token parameter">bizId</span>:业务ID
     * <span class="token keyword">@param</span> <span class="token parameter">extMap</span>:扩展字段
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>:异常
     * <span class="token keyword">@return</span> void
    */</span>
    <span class="token keyword">void</span> <span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> commodityId<span class="token punctuation">,</span> <span class="token class-name">String</span> bizId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="第三方方兑换卡" tabindex="-1"><a class="header-anchor" href="#第三方方兑换卡" aria-hidden="true">#</a> 第三⽅方兑换卡</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">IQiYiCardService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ICommodity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 第三⽅方兑换卡
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/12 下午11:49
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CardCommodityService</span> <span class="token keyword">implements</span> <span class="token class-name">ICommodity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">CardCommodityService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 模拟注⼊
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">IQiYiCardService</span> iQiYiCardService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">IQiYiCardService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 奖品发放接口
     * <span class="token keyword">@author</span> HCY
     * <span class="token keyword">@since</span> 2021/3/12 下午11:50
     * <span class="token keyword">@param</span> <span class="token parameter">uId</span>: 用户序号
     * <span class="token keyword">@param</span> <span class="token parameter">commodityId</span>:奖品ID
     * <span class="token keyword">@param</span> <span class="token parameter">bizId</span>:业务ID
     * <span class="token keyword">@param</span> <span class="token parameter">extMap</span>:扩展字段
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>:异常
     * <span class="token keyword">@return</span> void
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> commodityId<span class="token punctuation">,</span> <span class="token class-name">String</span> bizId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> mobile <span class="token operator">=</span> <span class="token function">queryUserMobile</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        iQiYiCardService<span class="token punctuation">.</span><span class="token function">grantToken</span><span class="token punctuation">(</span>mobile<span class="token punctuation">,</span> bizId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数[爱奇艺兑换卡] =&gt; uId：{} commodityId：{} bizId：{} extMap：{}&quot;</span><span class="token punctuation">,</span> uId<span class="token punctuation">,</span> commodityId<span class="token punctuation">,</span> bizId<span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>extMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果[爱奇艺兑换卡]：success&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">queryUserMobile</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;15200101232&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h4 id="优惠券" tabindex="-1"><a class="header-anchor" href="#优惠券" aria-hidden="true">#</a> 优惠券</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">CouponResult</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">CouponService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ICommodity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 优惠券
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/12 下午11:50
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CouponCommodityService</span> <span class="token keyword">implements</span> <span class="token class-name">ICommodity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">CouponCommodityService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">CouponService</span> couponService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CouponService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 奖品发放接口
     * <span class="token keyword">@author</span> HCY
     * <span class="token keyword">@since</span> 2021/3/12 下午11:50
     * <span class="token keyword">@param</span> <span class="token parameter">uId</span>: 用户序号
     * <span class="token keyword">@param</span> <span class="token parameter">commodityId</span>:奖品ID
     * <span class="token keyword">@param</span> <span class="token parameter">bizId</span>:业务ID
     * <span class="token keyword">@param</span> <span class="token parameter">extMap</span>:扩展字段
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>:异常
     * <span class="token keyword">@return</span> void
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> commodityId<span class="token punctuation">,</span> <span class="token class-name">String</span> bizId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">CouponResult</span> couponResult <span class="token operator">=</span> couponService<span class="token punctuation">.</span><span class="token function">sendCoupon</span><span class="token punctuation">(</span>uId<span class="token punctuation">,</span>
                commodityId<span class="token punctuation">,</span> bizId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数[优惠券] =&gt; uId:{} commodityId:{} bizId:{} extMap:{}&quot;</span><span class="token punctuation">,</span> uId<span class="token punctuation">,</span> commodityId<span class="token punctuation">,</span> bizId<span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>extMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果[优惠券]:{}&quot;</span><span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>couponResult<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token string">&quot;0000&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>couponResult<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span>couponResult<span class="token punctuation">.</span><span class="token function">getInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br></div></div><h4 id="实物接口" tabindex="-1"><a class="header-anchor" href="#实物接口" aria-hidden="true">#</a> 实物接口</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>alibaba<span class="token punctuation">.</span>fastjson<span class="token punctuation">.</span></span>JSON<span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>entity<span class="token punctuation">.</span></span><span class="token class-name">DeliverReq</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>code<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">GoodsService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ICommodity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Logger</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">org<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">LoggerFactory</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Map</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 实物接口
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/12 下午11:49
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GoodsCommodityService</span> <span class="token keyword">implements</span> <span class="token class-name">ICommodity</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">GoodsCommodityService</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">GoodsService</span> goodsService <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GoodsService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token doc-comment comment">/**
     * 奖品发放接口
     * <span class="token keyword">@author</span> HCY
     * <span class="token keyword">@since</span> 2021/3/12 下午11:50
     * <span class="token keyword">@param</span> <span class="token parameter">uId</span>: 用户序号
     * <span class="token keyword">@param</span> <span class="token parameter">commodityId</span>:奖品ID
     * <span class="token keyword">@param</span> <span class="token parameter">bizId</span>:业务ID
     * <span class="token keyword">@param</span> <span class="token parameter">extMap</span>:扩展字段
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>:异常
     * <span class="token keyword">@return</span> void
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">,</span> <span class="token class-name">String</span> commodityId<span class="token punctuation">,</span> <span class="token class-name">String</span> bizId<span class="token punctuation">,</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">DeliverReq</span> deliverReq <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeliverReq</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setUserName</span><span class="token punctuation">(</span><span class="token function">queryUserName</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setUserPhone</span><span class="token punctuation">(</span><span class="token function">queryUserPhoneNumber</span><span class="token punctuation">(</span>uId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setSku</span><span class="token punctuation">(</span>commodityId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setOrderId</span><span class="token punctuation">(</span>bizId<span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setConsigneeUserName</span><span class="token punctuation">(</span>extMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserName&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setConsigneeUserPhone</span><span class="token punctuation">(</span>extMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserPhone&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        deliverReq<span class="token punctuation">.</span><span class="token function">setConsigneeUserAddress</span><span class="token punctuation">(</span>extMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserAddress&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Boolean</span> isSuccess <span class="token operator">=</span> goodsService<span class="token punctuation">.</span><span class="token function">deliverGoods</span><span class="token punctuation">(</span>deliverReq<span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;请求参数[优惠券] =&gt; uId：{} commodityId：{} bizId：{} extMap：{}&quot;</span><span class="token punctuation">,</span> uId<span class="token punctuation">,</span> commodityId<span class="token punctuation">,</span> bizId<span class="token punctuation">,</span> JSON<span class="token punctuation">.</span><span class="token function">toJSON</span><span class="token punctuation">(</span>extMap<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        logger<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;测试结果[优惠券]：{}&quot;</span><span class="token punctuation">,</span> isSuccess<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>isSuccess<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;实物商品发放失败&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">queryUserName</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;晓寻遥&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> <span class="token function">queryUserPhoneNumber</span><span class="token punctuation">(</span><span class="token class-name">String</span> uId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token string">&quot;15200101232&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br></div></div><h3 id="factor" tabindex="-1"><a class="header-anchor" href="#factor" aria-hidden="true">#</a> factor</h3><h4 id="创建商店工厂" tabindex="-1"><a class="header-anchor" href="#创建商店工厂" aria-hidden="true">#</a> 创建商店⼯厂</h4><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span></span><span class="token class-name">ICommodity</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">CardCommodityService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">CouponCommodityService</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>hcy<span class="token punctuation">.</span>service<span class="token punctuation">.</span>impl<span class="token punctuation">.</span></span><span class="token class-name">GoodsCommodityService</span><span class="token punctuation">;</span>
<span class="token doc-comment comment">/**
 * 创建商店⼯厂
 * <span class="token keyword">@author</span> HCY
 * <span class="token keyword">@since</span> 2021/3/13 上午12:02
*/</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">StoreFactory</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token class-name">ICommodity</span> <span class="token function">getCommodityService</span><span class="token punctuation">(</span><span class="token class-name">Integer</span> commodityType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">null</span> <span class="token operator">==</span> commodityType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">==</span> commodityType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CouponCommodityService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">==</span> commodityType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">GoodsCommodityService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token number">3</span> <span class="token operator">==</span> commodityType<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CardCommodityService</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">RuntimeException</span><span class="token punctuation">(</span><span class="token string">&quot;不存在的商品服务类型&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br></div></div><p>从上面的代码中我们可以发现</p><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> 这里我们定义了了⼀一个商店的⼯厂类，在⾥里里⾯面按照类型实现各种商品的服务。可以⾮常⼲净整洁的处理你的代码，后续新增的商品在这里扩展即可。如果你不喜欢 if 判断，也可以使用 switch 或者 map 配置结构，会让代码更加干净。
</code></pre><div class="line-numbers"><span class="line-number">1</span><br></div></div><h3 id="测试" tabindex="-1"><a class="header-anchor" href="#测试" aria-hidden="true">#</a> 测试</h3><div class="language-java ext-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Test</span>
<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">test_commodity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token class-name">StoreFactory</span> storeFactory <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StoreFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 1. 优惠券</span>
    <span class="token class-name">ICommodity</span> commodityService_1 <span class="token operator">=</span> storeFactory<span class="token punctuation">.</span><span class="token function">getCommodityService</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    commodityService_1<span class="token punctuation">.</span><span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;EGM1023938910232121323432&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;791098764902132&quot;</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 2. 实物商品</span>
    <span class="token class-name">ICommodity</span> commodityService_2 <span class="token operator">=</span> storeFactory<span class="token punctuation">.</span><span class="token function">getCommodityService</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> extMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;谢飞机&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserPhone&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15200292123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    extMap<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserAddress&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;吉林省.长春市.双阳区.XX街道.檀溪苑小区.#18-2109&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    commodityService_2<span class="token punctuation">.</span><span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;9820198721311&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;1023000020112221113&quot;</span><span class="token punctuation">,</span><span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserName&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;谢飞机&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserPhone&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;15200292123&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;consigneeUserAddress&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;吉林省.长春市.双阳区.XX街道.檀溪苑小区.#18-2109&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 3. 第三方兑换卡(爱奇艺)</span>
    <span class="token class-name">ICommodity</span> commodityService_3 <span class="token operator">=</span> storeFactory<span class="token punctuation">.</span><span class="token function">getCommodityService</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    commodityService_3<span class="token punctuation">.</span><span class="token function">sendCommodity</span><span class="token punctuation">(</span><span class="token string">&quot;10001&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;AQY1xjkUodl8LO975GdfrYUio&quot;</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">,</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h3 id="测试factor" tabindex="-1"><a class="header-anchor" href="#测试factor" aria-hidden="true">#</a> 测试factor</h3><div class="language-config ext-config line-numbers-mode"><pre class="language-config"><code>模拟发放优惠券一张：10001,EGM1023938910232121323432,791098764902132
00:09:18.413 [main] INFO  c.h.s.impl.CouponCommodityService - 请求参数[优惠券] =&gt; uId:10001 commodityId:EGM1023938910232121323432 bizId:791098764902132 extMap:null
00:09:18.557 [main] INFO  c.h.s.impl.CouponCommodityService - 测试结果[优惠券]:{&quot;code&quot;:&quot;0000&quot;,&quot;info&quot;:&quot;发放成功&quot;}
模拟发货实物商品一个：{&quot;consigneeUserAddress&quot;:&quot;吉林省.长春市.双阳区.XX街道.檀溪苑小区.#18-2109&quot;,&quot;consigneeUserName&quot;:&quot;谢飞机&quot;,&quot;consigneeUserPhone&quot;:&quot;15200292123&quot;,&quot;orderId&quot;:&quot;1023000020112221113&quot;,&quot;sku&quot;:&quot;9820198721311&quot;,&quot;userName&quot;:&quot;晓寻遥&quot;,&quot;userPhone&quot;:&quot;15200101232&quot;}
00:09:18.584 [main] INFO  c.h.s.impl.GoodsCommodityService - 请求参数[优惠券] =&gt; uId：10001 commodityId：9820198721311 bizId：1023000020112221113 extMap：{&quot;consigneeUserName&quot;:&quot;谢飞机&quot;,&quot;consigneeUserAddress&quot;:&quot;吉林省.长春市.双阳区.XX街道.檀溪苑小区.#18-2109&quot;,&quot;consigneeUserPhone&quot;:&quot;15200292123&quot;}
00:09:18.584 [main] INFO  c.h.s.impl.GoodsCommodityService - 测试结果[优惠券]：true
模拟发放爱奇艺会员卡一张：15200101232，null
00:09:18.593 [main] INFO  c.h.s.impl.CardCommodityService - 请求参数[爱奇艺兑换卡] =&gt; uId：10001 commodityId：AQY1xjkUodl8LO975GdfrYUio bizId：null extMap：null
00:09:18.593 [main] INFO  c.h.s.impl.CardCommodityService - 测试结果[爱奇艺兑换卡]：success
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="总结" tabindex="-1"><a class="header-anchor" href="#总结" aria-hidden="true">#</a> 总结</h2><div class="language-markdown ext-md line-numbers-mode"><pre class="language-markdown"><code><span class="token list punctuation">-</span> 从上到下的优化来看，⼯厂⽅法模式并不复杂，甚⾄这样的开发结构在你有所理解后，会发现更加简单了。

<span class="token list punctuation">-</span> 那么这样的开发的好处知道后，也可以总结出来它的优点; 避免创建者与具体的产品逻辑耦合、满⾜单⼀职责，每⼀个业务逻辑实现都在所属⾃己的类中完成、满足开闭原则，⽆需更改使用调用方就可以 在程序中引入新的产品类型。但这样也会带来⼀些问题，⽐如有⾮常多的奖品类型，那么实现的⼦类会极速扩张。因此也需要使用其他的模式进行优化，这些在后续的设计模式中会逐步涉及到。从案例入手看设计模式往要⽐看理论学的更加容易，因为案例是缩短理论到上手的最佳方式，如果你已经有所收获，一定要去尝试实操。
</code></pre><div class="line-numbers"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="/inet.org/assets/app.44bb4c6a.js" defer></script>
  </body>
</html>
